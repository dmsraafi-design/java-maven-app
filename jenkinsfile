pipeline {
    agent any

    tools {
        maven 'mave-3.9'
    }

    stages {
      stage('Build jar') {
          steps {
              sh 'mvn package'
            }
        }

      stage('Build Image') {
        steps {
            scripts{
                echo "Building the Docker image..."
                withCredentials([usernamePassword(credentialsID: 'docker-hub-credential', passwordVariable: 'PASS', usernameVariable: 'USER')]) {
                    sh 'docker build -t dimasraafi1/demo-app:jma-2.0 .'
                    sh "echo \$PASS | docker login -u \$USER --password-stdin"
                    sh 'docker push dimasraafi1/demo-app:jma-2.0'
                }
            }
        }
    }
            
      stage('Deploy') {
          steps {
            script {
                  echo 'Deploying the application...'
            }
        }
    }
}
}
    

